---
# Dapr Secret Management component
# This enables Dapr to retrieve secrets from Kubernetes secrets

apiVersion: dapr.io/v1alpha1
kind: Component
metadata:
  name: kubernetes-secrets
  namespace: todo-app
  labels:
    app: todo-chatbot
    component: dapr
spec:
  type: secretstores.kubernetes.secrets
  version: v1
  metadata:
  - name: namespace
    value: "todo-app"
  - name: keySelector
    value: "value"
  scopes:
  - todo-backend

---
# Secret for Dapr PostgreSQL connection string
apiVersion: v1
kind: Secret
metadata:
  name: dapr-postgres-secret
  namespace: todo-app
  labels:
    app: todo-chatbot
    component: dapr
type: Opaque
stringData:
  # Connection string format: postgresql://user:password@host:port/database
  connection-string: "postgresql://todo_user:change-me-in-production@postgresql-service.todo-app.svc.cluster.local:5432/todo_db?sslmode=disable"
